{%extends "base.html"%}
{%block content%}

<header>
    <h2>{{month}} {{year}}</h2>
</header>

<main>
    <section>
        <div>
            <h4>Take Home Pay = {{take_home_pay}}</h4>
            <p>Your Take Home Pay can be updated in Settings</p>
        </div>
        <div>
            <h4>{{month}} Stats</h4>
            <table>
                <tr>
                    <th>Available Pin Money for {{month}}: </th>
                    {%if available_money > 100%}
                        <td class="green-text">{{available_money}}</td>
                    {%else%}
                        <td class="red-text">{{available_money}}</td>
                    {%endif%}
                </tr>
                <tr>
                    <th>Pin Money Transactions Total: </th>
                    <td>{{pin_money_total}}</td>
                </tr>
                <tr>
                    <th>Monthly Transactions Total: </th>
                    <td>£{{monthly_recurring_total}}</td>
                </tr>
            </table>
                {%if 0 < available_money < 100%}
                    <p class="red-text">CAUTION: Less than £100 pin money for the month</p>
                {%elif available_money <= 0%}
                    <p class="red-text">CAUTION: £0 Pin Money remaining for this month</p>
                {%endif%}
        </div>
        
        <div>
            <h3>Pin Money Transactions</h3>
            <table>
                <tr>
                    <th>Name</th>
                    <th>Cost</a></th>
                    <th>Date</a></th>
                    <th>Category </th>
                    <th>Vendor</th>
                    <th>Notes</th>
                </tr>
                {% for transaction in pin_money %}
                <tr>
                    <td>{{transaction.name}}</a></td>
                    <td>£{{transaction.cost}}</td>
                    <td>{{transaction.date.strftime("%d/%m/%Y")}}</td>
                    <td>{{transaction.category.name}}</td>
                    <td>{{transaction.vendor.name}}</td>
                    {%if transaction.notes == "None"%} <td></td>
                    {%elif transaction.notes == None%} <td></td>
                    {%else%}
                        <td>{{transaction.notes}}</td>
                    {%endif%}
                </tr>
                {%endfor%}
            </table>
            <p>Pin Money Transactions Total: £{{pin_money_total}}</p>
        </div>

        <div>
            <h3>Monthly Recurring Transactions</h3>
            <table>
                <tr>
                    <th>Name</th>
                    <th>Cost</a></th>
                    <th>Date</a></th>
                    <th>Category </th>
                    <th>Vendor</th>
                    <th>Notes</th>
                </tr>
                {% for transaction in monthly_recurring %}
                <tr>
                    <td>{{transaction.name}}</a></td>
                    <td>£{{transaction.cost}}</td>
                    <td>{{transaction.date.strftime("%d/%m/%Y")}}</td>
                    <td>{{transaction.category.name}}</td>
                    <td>{{transaction.vendor.name}}</td>
                    {%if transaction.notes == "None"%} <td></td>
                    {%elif transaction.notes == None%} <td></td>
                    {%else%}
                        <td>{{transaction.notes}}</td>
                    {%endif%}
                </tr>
                {%endfor%}
            </table>
            <p>Monthly Recurring Transactions Total: £{{monthly_recurring_total}}</p>
        </div>
    </section>

    <aside>
        <div>
            <h3>Next Goal</h3>
            <table>
                <tr>
                    <th>Goal Name:</th>
                    <td>{{goal.name}}</td>
                </tr>
                <tr>
                    <th>Savings Target:</th>
                    <td>{{goal.savings_target}}</td>
                </tr>
                <tr>
                    <th>Saved So Far:</th>
                    <td>{{goal.saved_so_far}}</td>
                </tr>
                <tr>
                    <th>Still to be Saved:</th>
                    <td>{{to_be_saved}}</td>
                </tr>
                <tr>
                    <th>To be Saved by:</th>
                    <td>{{goal.savings_time_frame.strftime("%d/%m/%Y")}}</td>
                </tr>
            </table>
            <p>{{time}}</p>
            <form action="/home/{{goal.id}}" method="POST">
                <label for="saved_so_far">Add Funds to the Savings Target: £</label>
                <input id="saved_so_far" name="saved_so_far" type="number" step=".01" required>
                <button type="submit">Add Funds</button>
            </form>
            <form action="/goals">
                <button type="submit">View All Goals</button>
            </form>
        </div>
    </aside>
</main>
{%endblock%}